#ifndef ____TYPE_UPPERCASE___DYNAMIC_ARRAY_H__
#define ____TYPE_UPPERCASE___DYNAMIC_ARRAY_H__

#include <memory.h>

#include "array_header.h"
#include "__TYPEDEF_FILE_NAME__"

typedef struct __TYPE__Array {
    ArrayHeader header;
    __TYPE__ data[10];
} __TYPE__Array;

// recomended initial capacity 10
__TYPE__Array* __TYPE__ArrayInit(int initialCapacity){
    size_t size = sizeof(__TYPE__) * initialCapacity + sizeof(ArrayHeader);
    __TYPE__Array* array = (__TYPE__Array*)malloc(size);

    if(!array){
        printf("Error allocation memory for __TYPE__Array %s::%d\n", __FILE__, __LINE__);
        exit(-1);
    }

    memset(array, 0, size);

    array->header.capacity = initialCapacity;
    array->header.elementSize = sizeof(__TYPE__);
    array->header.length = 0;
    return array;
}

void __TYPE__ArrayInsertElement(__TYPE__Array** self, __TYPE__ element){
    if((*self)->header.length + 1 == (*self)->header.capacity){
        *self = realloc(*self, (*self)->header.capacity * (*self)->header.elementSize * 2 + sizeof(ArrayHeader));
        if(*self == NULL) {
            printf("Error reallocating array\n");
            exit(-1);
        } else {
            (*self)->header.capacity *= 2;
        }
    }
    (*self)->data[(*self)->header.length++] = element;
}

void __TYPE__ArratFini(__TYPE__Array* array) {
    free(array);
}

#endif